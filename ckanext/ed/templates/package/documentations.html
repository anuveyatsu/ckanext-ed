{% if edit %}
  {% extends "package/edit_base.html" %}
{% else %}
  {% extends "package/read_base.html" %}
{% endif %}

{% set has_reorder = c.pkg_dict and c.pkg_dict.resources and c.pkg_dict.resources|length > 0 %}
{% set docs_here = {} %}

{% block page_primary_action %}
{% link_for _('Add new doc'), controller='ckanext.ed.controller:NewResourceController', action='new_doc', id=c.pkg_dict.name, class_='btn btn-primary', icon='plus' %}
{% endblock %}

{% block primary_content_inner %}
{% if pkg.resources %}
  <ul class="resource-list"{% if has_reorder %} data-module="resource-reorder" data-module-id="{{ pkg.id }}"{% endif %}>
    {% set can_edit = h.check_access('package_update', {'id':pkg.id }) %}
    {% for resource in pkg.resources %}
      {% if resource.resource_type == 'doc' %}
        <!-- Ugly workarund to update docs_here -->
        {% if docs_here.update({'here': True }) %} {% endif %}
        {% snippet 'package/snippets/resource_item.html', pkg=pkg, res=resource, url_is_edit=edit, can_edit=can_edit %}
      {% endif %}
    {% endfor %}
  </ul>
{% endif %}
{% if not docs_here.here %}
  {% trans url=h.url_for(controller='ckanext.ed.controller:NewResourceController', action='new_doc', id=pkg.name) %}
    <p class="empty">This dataset has no documentation, <a href="{{ url }}">why not add one?</a></p>
  {% endtrans %}
{% endif %}
{% endblock %}

{% block scripts %}
{{ super() }}
{% if has_reorder %}
  {% resource 'vendor/reorder' %}
{% endif %}
{% endblock %}
